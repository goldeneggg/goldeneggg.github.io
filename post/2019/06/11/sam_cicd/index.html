<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Language" content="en">

    <meta name="author" content="Fuminori Sakamoto">
    <meta name="description" content="Summary  AWS SAMã§ç®¡ç†ã—ã¦ã„ã‚‹Lambda Functionã®ãƒ‡ãƒ—ãƒ­ã‚¤è‡ªå‹•åŒ–ã‚’ã€AWS CodePipelineã‚„AWS CodeBuildã‚’ä½¿ã†ã“ã¨ãªã Travis CIã‚’æ´»ç”¨ã—ã¦è¡Œã†  ä»Šå›åˆ©ç”¨ã—ãŸLambda Functionã¯Goè£½ Pull Requestã®masterãƒ–ãƒ©ãƒ³ãƒã¸ã®mergeæ™‚ã«ã€samã‚³ãƒãƒ³ãƒ‰ã§è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤    å‰ææ¡ä»¶  Lambdaã®ãƒªãƒã‚¸ãƒˆãƒªã¯github å„ç¨®ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±ã¯ä¸‹è¨˜ã®é€šã‚Š  1 2 3 4 5 6 7 8 9 10 11  $ python --version Python 2.7.12 $ pip --version pip 19.0.3 from /usr/local/lib/python2.7/dist-packages/pip (python 2.7) $ aws --version aws-cli/1.16.175 Python/2.7.12 Linux/4.15.0-1028-gcp botocore/1.12.165 $ sam --version SAM CLI, version 0.17.0   SAMã§ç®¡ç†ã—ã¦ã„ã‚‹Lambdaã®ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’Travis CIã§è‡ªå‹•åŒ–ã—ãŸã„ SAMã§ç®¡ç†ã—ã¦ã„ã‚‹Lambdaã®ãƒ‡ãƒ—ãƒ­ã‚¤è‡ªå‹•åŒ–ã‚’Travis CIã§è¡Œã„ã¾ã™ã€‚SAMã§ç®¡ç†ã—ã¦ã„ã‚‹ã‹ã‚‰ã«ã¯SAMã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¨aws-sam-cliã‚’ä½¿ã£ã¦ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’è¡Œã„ãŸã„ã§ã™ã€‚ãªã®ã§Traviså…¬å¼ã®Lambdaãƒ‡ãƒ—ãƒ­ã‚¤ã‚µãƒãƒ¼ãƒˆã¯ä½¿ç”¨ã—ã¾ã›ã‚“ã€‚
 branch !">
    <meta name="keywords" content="blog,developer,backpacker,personal">

    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Travis CIã«ã‚ˆã‚‹Lambdaã®è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ with AWS SAM in Go"/>
<meta name="twitter:description" content="Summary  AWS SAMã§ç®¡ç†ã—ã¦ã„ã‚‹Lambda Functionã®ãƒ‡ãƒ—ãƒ­ã‚¤è‡ªå‹•åŒ–ã‚’ã€AWS CodePipelineã‚„AWS CodeBuildã‚’ä½¿ã†ã“ã¨ãªã Travis CIã‚’æ´»ç”¨ã—ã¦è¡Œã†  ä»Šå›åˆ©ç”¨ã—ãŸLambda Functionã¯Goè£½ Pull Requestã®masterãƒ–ãƒ©ãƒ³ãƒã¸ã®mergeæ™‚ã«ã€samã‚³ãƒãƒ³ãƒ‰ã§è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤    å‰ææ¡ä»¶  Lambdaã®ãƒªãƒã‚¸ãƒˆãƒªã¯github å„ç¨®ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±ã¯ä¸‹è¨˜ã®é€šã‚Š  1 2 3 4 5 6 7 8 9 10 11  $ python --version Python 2.7.12 $ pip --version pip 19.0.3 from /usr/local/lib/python2.7/dist-packages/pip (python 2.7) $ aws --version aws-cli/1.16.175 Python/2.7.12 Linux/4.15.0-1028-gcp botocore/1.12.165 $ sam --version SAM CLI, version 0.17.0   SAMã§ç®¡ç†ã—ã¦ã„ã‚‹Lambdaã®ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’Travis CIã§è‡ªå‹•åŒ–ã—ãŸã„ SAMã§ç®¡ç†ã—ã¦ã„ã‚‹Lambdaã®ãƒ‡ãƒ—ãƒ­ã‚¤è‡ªå‹•åŒ–ã‚’Travis CIã§è¡Œã„ã¾ã™ã€‚SAMã§ç®¡ç†ã—ã¦ã„ã‚‹ã‹ã‚‰ã«ã¯SAMã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¨aws-sam-cliã‚’ä½¿ã£ã¦ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’è¡Œã„ãŸã„ã§ã™ã€‚ãªã®ã§Traviså…¬å¼ã®Lambdaãƒ‡ãƒ—ãƒ­ã‚¤ã‚µãƒãƒ¼ãƒˆã¯ä½¿ç”¨ã—ã¾ã›ã‚“ã€‚
 branch !"/>

    <meta property="og:title" content="Travis CIã«ã‚ˆã‚‹Lambdaã®è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ with AWS SAM in Go" />
<meta property="og:description" content="Summary  AWS SAMã§ç®¡ç†ã—ã¦ã„ã‚‹Lambda Functionã®ãƒ‡ãƒ—ãƒ­ã‚¤è‡ªå‹•åŒ–ã‚’ã€AWS CodePipelineã‚„AWS CodeBuildã‚’ä½¿ã†ã“ã¨ãªã Travis CIã‚’æ´»ç”¨ã—ã¦è¡Œã†  ä»Šå›åˆ©ç”¨ã—ãŸLambda Functionã¯Goè£½ Pull Requestã®masterãƒ–ãƒ©ãƒ³ãƒã¸ã®mergeæ™‚ã«ã€samã‚³ãƒãƒ³ãƒ‰ã§è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤    å‰ææ¡ä»¶  Lambdaã®ãƒªãƒã‚¸ãƒˆãƒªã¯github å„ç¨®ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±ã¯ä¸‹è¨˜ã®é€šã‚Š  1 2 3 4 5 6 7 8 9 10 11  $ python --version Python 2.7.12 $ pip --version pip 19.0.3 from /usr/local/lib/python2.7/dist-packages/pip (python 2.7) $ aws --version aws-cli/1.16.175 Python/2.7.12 Linux/4.15.0-1028-gcp botocore/1.12.165 $ sam --version SAM CLI, version 0.17.0   SAMã§ç®¡ç†ã—ã¦ã„ã‚‹Lambdaã®ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’Travis CIã§è‡ªå‹•åŒ–ã—ãŸã„ SAMã§ç®¡ç†ã—ã¦ã„ã‚‹Lambdaã®ãƒ‡ãƒ—ãƒ­ã‚¤è‡ªå‹•åŒ–ã‚’Travis CIã§è¡Œã„ã¾ã™ã€‚SAMã§ç®¡ç†ã—ã¦ã„ã‚‹ã‹ã‚‰ã«ã¯SAMã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¨aws-sam-cliã‚’ä½¿ã£ã¦ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’è¡Œã„ãŸã„ã§ã™ã€‚ãªã®ã§Traviså…¬å¼ã®Lambdaãƒ‡ãƒ—ãƒ­ã‚¤ã‚µãƒãƒ¼ãƒˆã¯ä½¿ç”¨ã—ã¾ã›ã‚“ã€‚
 branch !" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://horizoon.jp/post/2019/06/11/sam_cicd/" />
<meta property="article:published_time" content="2019-06-11T17:16:54+09:00" />
<meta property="article:modified_time" content="2019-06-11T17:16:54+09:00" />


    <title>
  Travis CIã«ã‚ˆã‚‹Lambdaã®è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ with AWS SAM in Go Â· horizoon
</title>

    
      <link rel="canonical" href="https://horizoon.jp/post/2019/06/11/sam_cicd/">
    

    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather:300,700%7CSource+Code+Pro:400,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fork-awesome@1.1.7/css/fork-awesome.min.css"
      integrity="sha256-gsmEoJAws/Kd3CjuOQzLie5Q3yshhvmo7YNtBG7aaEY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/normalize.css@8/normalize.min.css">
    
      
      
      <link rel="stylesheet" href="https://horizoon.jp/css/coder.min.f01c647a0d25b40da992a37c3376291185eed8a50ced8c26cc2c0bcfe38c97df.css" integrity="sha256-8Bxkeg0ltA2pkqN8M3YpEYXu2KUM7YwmzCwLz&#43;OMl98=" crossorigin="anonymous" media="screen" />
    

    

    
      
        
        
        <link rel="stylesheet" href="https://horizoon.jp/css/coder-dark.min.126ad3988d46bdae6217a11105b53c9662bca05f39d42d3c0fb366919d334620.css" integrity="sha256-EmrTmI1Gva5iF6ERBbU8lmK8oF851C08D7NmkZ0zRiA=" crossorigin="anonymous" media="screen" />
      
    

    

    

    <link rel="icon" type="image/png" href="https://horizoon.jp/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="https://horizoon.jp/favicon-16x16.png" sizes="16x16">

    <link rel="apple-touch-icon" href="https://horizoon.jp/images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="180x180" href="https://horizoon.jp/images/apple-touch-icon.png">

    

    <meta name="generator" content="Hugo 0.79.1" />
  </head>

  
  
    
  
  <body class="colorscheme-auto"
        onload=""
  >
    
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="https://horizoon.jp/">
      horizoon
    </a>
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link" href="https://horizoon.jp/post/">Blog</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="https://horizoon.jp/projects/">Projects</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="https://horizoon.jp/about/">About</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


      <div class="content">
        
  <section class="container page">
  <article>
    <header>
      <h1>Travis CIã«ã‚ˆã‚‹Lambdaã®è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ with AWS SAM in Go</h1>
    </header>

    <h2 id="summary">Summary</h2>
<ul>
<li>AWS SAMã§ç®¡ç†ã—ã¦ã„ã‚‹Lambda Functionã®ãƒ‡ãƒ—ãƒ­ã‚¤è‡ªå‹•åŒ–ã‚’ã€<strong>AWS CodePipelineã‚„AWS CodeBuildã‚’ä½¿ã†ã“ã¨ãªã</strong> Travis CIã‚’æ´»ç”¨ã—ã¦è¡Œã†
<ul>
<li>ä»Šå›åˆ©ç”¨ã—ãŸLambda Functionã¯Goè£½</li>
<li>Pull Requestã®masterãƒ–ãƒ©ãƒ³ãƒã¸ã®mergeæ™‚ã«ã€samã‚³ãƒãƒ³ãƒ‰ã§è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤</li>
</ul>
</li>
</ul>
<h2 id="å‰ææ¡ä»¶">å‰ææ¡ä»¶</h2>
<ul>
<li>Lambdaã®ãƒªãƒã‚¸ãƒˆãƒªã¯github</li>
<li>å„ç¨®ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±ã¯ä¸‹è¨˜ã®é€šã‚Š</li>
</ul>
<div class="highlight"><div style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ python --version
Python 2.7.12

$ pip --version
pip 19.0.3 from /usr/local/lib/python2.7/dist-packages/pip (python 2.7)

$ aws --version
aws-cli/1.16.175 Python/2.7.12 Linux/4.15.0-1028-gcp botocore/1.12.165

$ sam --version
SAM CLI, version 0.17.0
</code></pre></td></tr></table>
</div>
</div><h2 id="samã§ç®¡ç†ã—ã¦ã„ã‚‹lambdaã®ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’travis-ciã§è‡ªå‹•åŒ–ã—ãŸã„">SAMã§ç®¡ç†ã—ã¦ã„ã‚‹Lambdaã®ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’Travis CIã§è‡ªå‹•åŒ–ã—ãŸã„</h2>
<p>SAMã§ç®¡ç†ã—ã¦ã„ã‚‹Lambdaã®ãƒ‡ãƒ—ãƒ­ã‚¤è‡ªå‹•åŒ–ã‚’Travis CIã§è¡Œã„ã¾ã™ã€‚SAMã§ç®¡ç†ã—ã¦ã„ã‚‹ã‹ã‚‰ã«ã¯SAMã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¨aws-sam-cliã‚’ä½¿ã£ã¦ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’è¡Œã„ãŸã„ã§ã™ã€‚ãªã®ã§<a href="https://docs.travis-ci.com/user/deployment/lambda/">Traviså…¬å¼ã®Lambdaãƒ‡ãƒ—ãƒ­ã‚¤ã‚µãƒãƒ¼ãƒˆ</a>ã¯ä½¿ç”¨ã—ã¾ã›ã‚“ã€‚</p>
<ul>
<li>branch != master ã®å ´åˆã®CI
<ol>
<li>Lambdaã‚³ãƒ¼ãƒ‰ã®ãƒ†ã‚¹ãƒˆ</li>
<li>Lambdaã‚³ãƒ¼ãƒ‰ã®lintï¼ˆgolintã‚„go vetãªã©ï¼‰</li>
<li><code>sam validate</code></li>
</ol>
</li>
<li>branch == master ã®å ´åˆã®CI, ãƒ‡ãƒ—ãƒ­ã‚¤
<ol>
<li>CIæ™‚ã«å®Ÿæ–½ã—ãŸäº‹å…¨ã¦</li>
<li><code>sam package</code></li>
<li><code>sam deploy</code></li>
</ol>
</li>
</ul>
<p>ã“ã‚Œã‚‰ã‚’.travis.ymlã§å®šç¾©ã—ã¦ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’è‡ªå‹•åŒ–ã—ã¾ã™ã€‚</p>
<h3 id="ã‚»ã‚­ãƒ¥ã‚¢ãªç’°å¢ƒå¤‰æ•°ã®è¨­å®š">ã‚»ã‚­ãƒ¥ã‚¢ãªç’°å¢ƒå¤‰æ•°ã®è¨­å®š</h3>
<p>Travis CIã§samã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ãŸã„å ´åˆã«å¿…è¦ãªç’°å¢ƒå¤‰æ•°ã¯ä¸‹è¨˜ã®3ã¤ã§ã™ã€‚</p>
<ul>
<li>AWS_ACCESS_KEY_ID</li>
<li>AWS_SECRET_ACCESS_KEY</li>
<li>AWS_DEFAULT_REGION</li>
</ul>
<p>ã‚»ã‚­ãƒ¥ã‚¢ãªå¤‰æ•°ã¯ <a href="https://docs.travis-ci.com/user/environment-variables/#defining-encrypted-variables-in-travisyml"><code>travis encrypt</code> ã‚³ãƒãƒ³ãƒ‰ã§æš—å·åŒ–ã—ã¦.travis.yml ã«è¨­å®šã—ã¾ã™</a>ã€‚</p>
<div class="highlight"><div style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ travis encrypt <span style="color:#bb60d5">AWS_ACCESS_KEY_ID</span><span style="color:#666">=</span>YOUR_KEY_ID

Please add the following to your .travis.yml file:

  secure: <span style="color:#4070a0">&#34;XXX&#34;</span>  <span style="color:#60a0b0;font-style:italic"># ã“ã®å†…å®¹ã‚’.travis.ymlã«è¨­å®šã™ã‚‹</span>

$ travis encrypt <span style="color:#bb60d5">AWS_SECRET_ACCESS_KEY</span><span style="color:#666">=</span>YOUR_KEY

Please add the following to your .travis.yml file:

  secure: <span style="color:#4070a0">&#34;XXX&#34;</span>  <span style="color:#60a0b0;font-style:italic"># ã“ã®å†…å®¹ã‚’.travis.ymlã«è¨­å®šã™ã‚‹</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="travisyml">.travis.yml</h3>
<div class="highlight"><div style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#062873;font-weight:bold">dist</span>:<span style="color:#bbb"> </span>xenial<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#062873;font-weight:bold">go</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>- <span style="color:#40a070">1.12</span>.x<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#062873;font-weight:bold">sudo</span>:<span style="color:#bbb"> </span><span style="color:#007020;font-weight:bold">false</span><span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#062873;font-weight:bold">env</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">matrix</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>- GO111MODULE=on<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">global</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>- AWS_DEFAULT_REGION=ap-northeast-1<span style="color:#bbb">
</span><span style="color:#bbb">    </span>- <span style="color:#062873;font-weight:bold">secure</span>:<span style="color:#bbb"> </span>ENCRYPTED_ACCESS_KEY_ID<span style="color:#bbb">
</span><span style="color:#bbb">    </span>- <span style="color:#062873;font-weight:bold">secure</span>:<span style="color:#bbb"> </span>ENCRYPTED_SECRET_ACCESS_KEY<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#062873;font-weight:bold">install</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>- go mod download<span style="color:#bbb">
</span><span style="color:#bbb">  </span>- python --version<span style="color:#bbb">
</span><span style="color:#bbb">  </span>- pip --version<span style="color:#bbb">
</span><span style="color:#bbb">  </span>- pip install --user awscli<span style="color:#bbb">
</span><span style="color:#bbb">  </span>- pip install --user aws-sam-cli<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#062873;font-weight:bold">script</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>- go test ./...<span style="color:#bbb">
</span><span style="color:#bbb">  </span>- sam validate<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#062873;font-weight:bold">deploy</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">provider</span>:<span style="color:#bbb"> </span>script<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">script</span>:<span style="color:#bbb"> </span><span style="color:#4070a0">&#34;./deploy.sh&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">skip_cleanup</span>:<span style="color:#bbb"> </span><span style="color:#007020;font-weight:bold">true</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">on</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#062873;font-weight:bold">branch</span>:<span style="color:#bbb"> </span>master<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#062873;font-weight:bold">notifications</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">email</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#062873;font-weight:bold">on_success</span>:<span style="color:#bbb"> </span>never<span style="color:#bbb">
</span></code></pre></td></tr></table>
</div>
</div><p>pythonã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒå¤ã„ã¨<code>sam</code>ã‚³ãƒãƒ³ãƒ‰ãŒã‚³ã‚±ã‚‹ã®ã§<a href="https://docs.travis-ci.com/user/reference/xenial/#python-support"><code>dist: xenial</code>ã§Xenialãƒ™ãƒ¼ã‚¹ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’æŒ‡å®šã—ã€æ¥µåŠ›æ–°ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®pythonã‚’åˆ©ç”¨</a>ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚</p>
<p><code>language: go</code>ãªãƒ“ãƒ«ãƒ‰ã‚¤ãƒ¡ãƒ¼ã‚¸ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹pythonã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯ã€<code>dist: xenial</code>ã‚’æŒ‡å®šã—ãªã„ï¼<code>dist: trusty</code>ãŒé¸æŠã•ã‚Œã‚Œã°ï¼ˆã“ã®è¨˜äº‹ã®åŸ·ç­†æ™‚ç‚¹ã§ã¯ï¼‰2.7.6ã«ãªã‚Šã¾ã™ã€‚ä¾‹ãˆã°<code>sam validate</code>ã‚’ver 2.7.6ãªpythonç’°å¢ƒã§å®Ÿè¡Œã™ã‚‹ã¨ã€SNIMissingWarningãŒç™ºç”Ÿã—ã¦ã—ã¾ã„ã¾ã™ã€‚</p>
<div class="highlight"><div style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">/home/travis/.local/lib/python2.7/site-packages/urllib3/util/ssl_.py:365: SNIMissingWarning: An HTTPS request has been made, but the SNI (Server Name Indication) extension to TLS is not available on this platform.
This may cause the server to present an incorrect TLS certificate, which can cause validation failures.
You can upgrade to a newer version of Python to solve this. For more information, see https://urllib3.readthedocs.io/en/latest/advanced-usage.html#ssl-warnings
  SNIMissingWarning
</code></pre></td></tr></table>
</div>
</div><p>deployã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®scriptã§<code>go build</code> =&gt; <code>sam package</code> =&gt; <code>sam deploy</code>ã‚’å®Ÿè¡Œã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ç”¨æ„ãƒ»æŒ‡å®šã—ã¾ã™ã€‚</p>
<div class="highlight"><div style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#007020">#!/bin/bash
</span><span style="color:#007020"></span>
<span style="color:#60a0b0;font-style:italic"># ./deploy.sh</span>

<span style="color:#007020">set</span> -eu

<span style="color:#60a0b0;font-style:italic"># template.yamlã®Resourcesã®é–¢æ•°å®šç¾©ã®å†…å®¹ã¨åˆã‚ã›ã‚‹</span>
<span style="color:#60a0b0;font-style:italic"># ä¾‹ãˆã°</span>
<span style="color:#60a0b0;font-style:italic">#   CodeUri: hoge/</span>
<span style="color:#60a0b0;font-style:italic">#   Handler: huga</span>
<span style="color:#60a0b0;font-style:italic"># ã§ã‚ã‚Œã°ã€</span>
<span style="color:#60a0b0;font-style:italic">#   CODE_URI=hoge/</span>
<span style="color:#60a0b0;font-style:italic">#   HANDLER=huga</span>
<span style="color:#60a0b0;font-style:italic"># ã¨ã™ã‚‹</span>

<span style="color:#bb60d5">CODE_URI</span><span style="color:#666">=</span>hoge/
<span style="color:#bb60d5">HANDLER</span><span style="color:#666">=</span>huga
<span style="color:#bb60d5">GOOS</span><span style="color:#666">=</span>linux <span style="color:#bb60d5">GOARCH</span><span style="color:#666">=</span>amd64 go build -o <span style="color:#70a0d0;font-style:italic">${</span><span style="color:#bb60d5">CODE_URI</span><span style="color:#70a0d0;font-style:italic">}${</span><span style="color:#bb60d5">HANDLER</span><span style="color:#70a0d0;font-style:italic">}</span> <span style="color:#70a0d0;font-style:italic">${</span><span style="color:#bb60d5">CODE_URI</span><span style="color:#70a0d0;font-style:italic">}</span>main.go

<span style="color:#bb60d5">TEMPLATE</span><span style="color:#666">=</span>./template.yaml
<span style="color:#bb60d5">OUTPUT_TEMPLATE</span><span style="color:#666">=</span>./serverless-output.yaml  <span style="color:#60a0b0;font-style:italic"># ãƒ‡ãƒ—ãƒ­ã‚¤ç”¨ã®ä¸­é–“ç”Ÿæˆç‰©ãªã®ã§gitignoreã—ã¦ãŠãã®ãŒè‰¯ã„ã§ã™</span>
<span style="color:#bb60d5">S3_BUCKET</span><span style="color:#666">=</span>YOUR_BUCKET
<span style="color:#bb60d5">S3_PREFIX</span><span style="color:#666">=</span>YOUR_PREFIX
<span style="color:#bb60d5">STACK</span><span style="color:#666">=</span>YOUR_STACK

sam package --template-file <span style="color:#70a0d0;font-style:italic">${</span><span style="color:#bb60d5">TEMPLATE</span><span style="color:#70a0d0;font-style:italic">}</span> <span style="color:#4070a0;font-weight:bold">\
</span><span style="color:#4070a0;font-weight:bold"></span>  --output-template-file <span style="color:#70a0d0;font-style:italic">${</span><span style="color:#bb60d5">OUTPUT_TEMPLATE</span><span style="color:#70a0d0;font-style:italic">}</span> <span style="color:#4070a0;font-weight:bold">\
</span><span style="color:#4070a0;font-weight:bold"></span>  --s3-bucket <span style="color:#70a0d0;font-style:italic">${</span><span style="color:#bb60d5">S3_BUCKET</span><span style="color:#70a0d0;font-style:italic">}</span> <span style="color:#4070a0;font-weight:bold">\
</span><span style="color:#4070a0;font-weight:bold"></span>  --s3-prefix <span style="color:#70a0d0;font-style:italic">${</span><span style="color:#bb60d5">S3_PREFIX</span><span style="color:#70a0d0;font-style:italic">}</span>

sam deploy --template-file <span style="color:#70a0d0;font-style:italic">${</span><span style="color:#bb60d5">OUTPUT_TEMPLATE</span><span style="color:#70a0d0;font-style:italic">}</span> <span style="color:#4070a0;font-weight:bold">\
</span><span style="color:#4070a0;font-weight:bold"></span>  --stack-name <span style="color:#70a0d0;font-style:italic">${</span><span style="color:#bb60d5">STACK</span><span style="color:#70a0d0;font-style:italic">}</span> <span style="color:#4070a0;font-weight:bold">\
</span><span style="color:#4070a0;font-weight:bold"></span>  --capabilities CAPABILITY_IAM
</code></pre></td></tr></table>
</div>
</div><p>ã“ã‚Œã§ã€ä»Šå¾Œmasterãƒ–ãƒ©ãƒ³ãƒã¸ã®pushã‚’ãƒˆãƒªã‚¬ãƒ¼ã«<code>go build</code> =&gt; <code>sam package</code> =&gt; <code>sam deploy</code> ã«ã‚ˆã‚‹ãƒ‡ãƒ—ãƒ­ã‚¤ãŒè‡ªå‹•ã§è¡Œã‚ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</p>
<p>ä»Šå›ã®ä¾‹ã®ã‚ˆã†ã«<code>sam package</code> =&gt; <code>sam deploy</code> ã‚’ã‚·ãƒ³ãƒ—ãƒ«ã«å®Ÿè¡Œã™ã‚‹ã ã‘ã®ãƒ•ãƒ­ãƒ¼ã§ã‚ã‚Œã°ï¼ˆä¸”ã¤CodePipelineå°å…¥ã«ã‚ˆã‚‹ãƒ¡ãƒªãƒƒãƒˆã‚’äº«å—ã—ãŸã„å¼·ã„ç†ç”±ãŒç„¡ã‘ã‚Œã°ï¼‰ã€Travis CIã§ã‚‚ååˆ†ã§ã—ãŸã€ã¨ã„ã†æ‰€æ„Ÿã§ã™ã€‚</p>
<h2 id="ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯">ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯</h2>
<ul>
<li><a href="https://dev.to/codevbus/deploy-aws-lambda-functions-with-aws-sam-cli-and-travis-ci-3m9m">Deploy AWS Lambda functions with aws-sam-cli and Travis-CI - DEV Community ğŸ‘©â€ğŸ’»ğŸ‘¨â€ğŸ’»</a></li>
<li><a href="https://dev.to/codevbus/deploy-aws-lambda-functions-with-aws-sam-cli-and-travis-ci-part-2-2goh">Deploy AWS Lambda functions with aws-sam-cli and Travis-CI: Part 2 - DEV Community ğŸ‘©â€ğŸ’»ğŸ‘¨â€ğŸ’»</a></li>
<li><a href="https://docs.aws.amazon.com/ja_jp/lambda/latest/dg/build-pipeline.html">AWS CodePipeline ã‚’ä½¿ç”¨ã—ã¦ Lambda ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ç¶™ç¶šçš„ãªé…ä¿¡ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’æ§‹ç¯‰ã™ã‚‹ - AWS Lambda</a></li>
<li><a href="https://github.com/aws-samples/cookiecutter-aws-sam-pipeline">aws-samples/cookiecutter-aws-sam-pipeline: Cookiecutter is an Open Source BSD-3 licensed that provides a template engine to scaffold projects. This project is a a cookiecutter template to create a generic CI/CD pipeline for Serverless App based on Serverless Application Model (SAM).</a></li>
<li><a href="https://github.com/Giftbit/sam-scaffold">Giftbit/sam-scaffold: A template for an AWS SAM project with continuous integration.</a>
<ul>
<li>AWS SAMã§ç®¡ç†ã—ã¦ã„ã‚‹Lambdaãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå‘ã‘ã®CIé››å½¢é›†</li>
</ul>
</li>
</ul>

  </article>
</section>

  

      </div>

      
  <footer class="footer">
    <section class="container">
      
      
        Â©
        
          2017 -
        
        2021
         Fuminori Sakamoto 
      
      
         Â· 
        Powered by <a href="https://gohugo.io/">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/">Coder</a>.
      
      
    </section>
  </footer>


    </main>

    
      
        
        <script src="https://horizoon.jp/js/dark-mode.min.0213e1773e6d1c5a644f847c67a6f8abac49a3776e2976f6008038af8c5b76a1.js"></script>
      
    

    

    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-129776715-1', 'auto');
	
	ga('send', 'pageview');
}
</script>


    

    

    

    
  </body>

</html>
